"use strict";function calculateISKperm3(c,a){var b=c.tritanium*a.tritanium;b+=c.pyerite*a.pyerite;b+=c.mexallon*a.mexallon;b+=c.isogen*a.isogen;b+=c.nocxium*a.nocxium;b+=c.zydrine*a.zydrine;b+=c.megacyte*a.megacyte;b+=c.morphite*a.morphite;b/=a.volume;b/=a.batchsize;return b}function getNiceNumber(a){a=a.replace(" ","");var c=document.getElementById(a);if(!c){return 0}var b=c.value;var e=b.indexOf("%");if(e!=-1){b=b.substr(0,e)/100}var d=b*1;if(!isNaN(d)){return d}else{document.getElementById(a).value="NaN";return 0}}function updateStatus(a,b){document.getElementById("page-status").innerHTML=a;document.getElementById("page-status").className=b}function moneyFormat(c){var a=Math.floor(c);var b=Math.round((c-a)*100);if(b<10){b="0"+b}return a+"."+b}function getPrices(){var a=getNiceNumber("tritanium-price");var b=getNiceNumber("pyerite-price");var f=getNiceNumber("mexallon-price");var h=getNiceNumber("isogen-price");var d=getNiceNumber("nocxium-price");var c=getNiceNumber("zydrine-price");var e=getNiceNumber("megacyte-price");var g=getNiceNumber("morphite-price");return{tritanium:a,pyerite:b,mexallon:f,isogen:h,nocxium:d,zydrine:c,megacyte:e,morphite:g}}function findElement(b,c){for(var a=0;a<b.length;a++){if(b[a].id==c){return b[a]}}return null}function populateMarketData(){var c=new XMLHttpRequest();c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var j=c.responseXML.getElementsByTagName("marketstat")[0];var l=j.getElementsByTagName("type");var k=document.getElementsByName("price-type");var g="avg";for(var f=0;f<k.length;f++){if(k[f].checked){g=k[f].value}}for(var f=0;f<b.length;f++){var e=findElement(l,b[f].id);if(e){var h=e.getElementsByTagName("buy")[0].getElementsByTagName(g)[0].textContent}else{var h=0}document.getElementById(b[f].name+"-price").value=h}updateStatus("Prices Updated","ok")}else{if(c.readyState==4){updateStatus("An error occurred while loading price data (status "+c.status+" returned)","error")}}};var b=new Array({id:34,name:"tritanium"},{id:35,name:"pyerite"},{id:36,name:"mexallon"},{id:37,name:"isogen"},{id:38,name:"nocxium"},{id:39,name:"zydrine"},{id:40,name:"megacyte"},{id:11399,name:"morphite"},{id:1223,name:"bistot"},{id:1224,name:"pyroxeres"},{id:1225,name:"crokite"},{id:1226,name:"jaspet"},{id:1227,name:"omber"},{id:1228,name:"scordite"},{id:1229,name:"gneiss"},{id:1230,name:"veldspar"},{id:1231,name:"hemorphite"},{id:1232,name:"darkochre"},{id:18,name:"plagioclase"},{id:19,name:"spodumain"},{id:20,name:"kernite"},{id:21,name:"hedbergite"},{id:22,name:"arkonor"},{id:11396,name:"mercoxit"});var d="";for(var a=0;a<b.length;a++){d+="typeid="+b[a].id+"&"}d+="regionlimit="+document.getElementById("eve-central-region").value;updateStatus("Loading Price Data...","busy");c.open("POST","http://api.eve-central.com/api/marketstat",true);c.setRequestHeader("User-Agent","JavaScript/Ore Calculator 0.1dev");c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(d)}function toggleAdvanced(){if(document.getElementById("advanced").style.display!="block"){document.getElementById("advanced").style.display="block"}else{document.getElementById("advanced").style.display="none"}}function recalculate(){var x=new Array("tritanium","pyerite","mexallon","isogen","nocxium","zydrine","megacyte","morphite");var m=new Array({name:"Veldspar",batchsize:333,tritanium:1000,volume:0.1},{name:"Scordite",batchsize:333,tritanium:833,pyerite:416,volume:0.15},{name:"Pyroxeres",batchsize:333,tritanium:844,pyerite:59,mexallon:120,nocxium:11,volume:0.3},{name:"Plagioclase",batchsize:333,tritanium:256,pyerite:512,mexallon:256,volume:0.35},{name:"Omber",batchsize:500,tritanium:307,pyerite:123,isogen:307,volume:0.6},{name:"Kernite",batchsize:400,tritanium:386,mexallon:773,isogen:386,volume:1.2},{name:"Jaspet",batchsize:500,tritanium:259,pyerite:259,mexallon:518,nocxium:259,zydrine:8,volume:2},{name:"Hemorphite",batchsize:500,tritanium:212,isogen:212,nocxium:424,zydrine:28,volume:3},{name:"Hedbergite",batchsize:500,isogen:708,nocxium:354,zydrine:32,volume:3},{name:"Gneiss",batchsize:400,tritanium:171,mexallon:171,isogen:343,zydrine:171,volume:5},{name:"Dark Ochre",batchsize:400,tritanium:250,nocxium:500,zydrine:250,volume:8},{name:"Crokite",batchsize:250,tritanium:331,nocxium:331,zydrine:663,volume:16},{name:"Spodumain",batchsize:250,tritanium:700,pyerite:140,megacyte:140,volume:16},{name:"Bistot",batchsize:200,pyerite:170,zydrine:341,megacyte:170,volume:16},{name:"Arkonor",batchsize:200,tritanium:300,zydrine:166,megacyte:333,volume:16},{name:"Mercoxit",batchsize:250,morphite:530,volume:40});var b=new Array({name:"Condensed Alloy",batchsize:1,tritanium:88,pyerite:44,mexallon:11,volume:1},{name:"Crystal Compound",batchsize:1,mexallon:11,isogen:2,volume:1},{name:"Precious Alloy",batchsize:1,pyerite:7,isogen:18,volume:1},{name:"Sheen Compound",batchsize:1,tritanium:124,pyerite:44,isogen:23,nocxium:1,volume:1},{name:"Gleaming Alloy",batchsize:1,tritanium:299,nocxium:5,volume:1},{name:"Lucent Compound",batchsize:1,pyerite:174,mexallon:2,isogen:11,nocxium:5,volume:1},{name:"Dark Compound",batchsize:1,isogen:23,nocxium:10,volume:1},{name:"Motley Compound",batchsize:1,isogen:28,nocxium:13,volume:1},{name:"Lustering Alloy",batchsize:1,mexallon:88,isogen:32,nocxium:35,zydrine:1,volume:1},{name:"Glossy Compound",batchsize:1,mexallon:210,nocxium:4,megacyte:3,volume:1},{name:"Plush Compound",batchsize:1,tritanium:3200,pyerite:800,isogen:20,zydrine:9,volume:1},{name:"Opulent Compound",batchsize:1,morphite:2,volume:1});for(var r=0;r<x.length;r++){var a=x[r];for(var s=0;s<m.length;s++){if(m[s][a]===undefined){m[s][a]=0}}for(var s=0;s<b.length;s++){if(b[s][a]===undefined){b[s][a]=0}}}var d=getPrices();var z=1;var y={};for(var p in m){y[m[p].name]=1}if(document.getElementById("advanced").style.display=="block"){var q=getNiceNumber("refining-skill");var A=getNiceNumber("efficiency-skill");var g=getNiceNumber("facility-efficiency");var w=getNiceNumber("facility-standing");var n=Math.max((0.05*((20/3)-w))*(3/20),0);document.getElementById("facility").getElementsByTagName("h2")[0].innerHTML="Facility [+"+Math.round((g-n)*1000)/10+"%]";var f=0.375*(1+0.02*q)*(1+0.04*A);document.getElementById("skills").getElementsByTagName("h2")[0].innerHTML="Skills [+"+Math.round(f*1000)/10+"%]";z=g+f;for(var p in m){var B=m[p].name;var t=getNiceNumber(B.toLowerCase()+"-skill");y[B]=Math.min(g+f*(1+0.05*t),1)-n}}document.getElementById("estimated-efficiency").innerHTML="Estimated Base Refining Efficiency: "+Math.round(z*1000)/10+"%";var v=document.getElementById("ores");var k="<thead><tr><th>Ore</th><th>Batch Size</th><th>Tritanium</th><th>Pyerite</th><th>Mexallon</th><th>Isogen</th><th>Nocxium</th><th>Zydrine</th><th>Megacyte</th><th>Morphite</th><th>ISK/m<sup>3</sup> (Raw)</th><th>ISK/m<sup>3</sup> (Refined)</th></tr></thead><tbody>";for(var s=0;s<m.length;s++){var u=y[m[s].name];for(var r=0;r<x.length;r++){var a=x[r];m[s][a]=Math.ceil(m[s][a]*u)}var l=getNiceNumber(m[s].name.toLowerCase()+"-price");var c=moneyFormat(l/m[s].volume);var h=moneyFormat(calculateISKperm3(d,m[s]));k+="<tr>";k+="<td>"+m[s].name+"</td>";k+="<td>"+m[s].batchsize+"</td>";k+="<td>"+m[s].tritanium+"</td>";k+="<td>"+m[s].pyerite+"</td>";k+="<td>"+m[s].mexallon+"</td>";k+="<td>"+m[s].isogen+"</td>";k+="<td>"+m[s].nocxium+"</td>";k+="<td>"+m[s].zydrine+"</td>";k+="<td>"+m[s].megacyte+"</td>";k+="<td>"+m[s].morphite+"</td>";k+="<td>"+c+"</td>";k+="<td>"+h+"</td>";k+="</tr>"}k+="</tbody>";v.innerHTML=k;v=document.getElementById("compounds");var k="<thead><tr><th>Compound</th><th>Batch Size</th><th>Tritanium</th><th>Pyerite</th><th>Mexallon</th><th>Isogen</th><th>Nocxium</th><th>Zydrine</th><th>Megacyte</th><th>Morphite</th><th>ISK/m<sup>3</sup> (Raw)</th><th>ISK/m<sup>3</sup> (Refined)</th></tr></thead><tbody>";for(var s=0;s<b.length;s++){var h=moneyFormat(calculateISKperm3(d,b[s]));k+="<tr>";k+="<td>"+b[s].name+"</td>";k+="<td>"+b[s].batchsize+"</td>";k+="<td>"+b[s].tritanium+"</td>";k+="<td>"+b[s].pyerite+"</td>";k+="<td>"+b[s].mexallon+"</td>";k+="<td>"+b[s].isogen+"</td>";k+="<td>"+b[s].nocxium+"</td>";k+="<td>"+b[s].zydrine+"</td>";k+="<td>"+b[s].megacyte+"</td>";k+="<td>"+b[s].morphite+"</td>";k+="<td>"+h+"</td>";k+="<td>"+h+"</td>";k+="</tr>"}k+="</tbody>";v.innerHTML=k;sortables_init()};
